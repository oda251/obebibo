# Obebibo 仕様書

## プロジェクト概要

- fanabe というサービスを模倣した Web サイトの作成
- 技術検証・学習目的（ユーザ利用は想定しない）

## 目的

- fanabe サービスの模倣
- Web サービス開発技術の習得・確認

## ターゲットユーザー

- なし（公開・利用は目的としない）

## 主要機能（案）

- 試供品の提供に関する
  - 応募
  - 配送
  - 利用確認

## 実行方法

- `docker compose up -d`で起動
  - ローカル環境のみ想定

---

# Obebibo 仕様書（ドラフト・模倣元サイト観察ベース）

## 1. サービス概要

- 試供品（モニター商品）の提供を希望するユーザーが、案件に応募し、当選した場合に商品を受け取れる仕組みを提供する。
- 案件ごとに「応募」「当選」「購入・利用確認」などのフローが存在する。

## 2. 主要機能

### 2.1 案件一覧・詳細

- 現在募集中のモニター案件を一覧表示
- 各案件の詳細ページ（商品説明、応募条件、当選人数、応募締切など）

### 2.2 応募機能

- ユーザーが案件に応募できる
- 応募には会員登録・ログインが必要（本プロジェクトではダミーでも可）

### 2.3 当選管理

- 応募者の中から当選者を選定（自動/手動）
- 当選者への通知（メール or サイト内通知）

### 2.4 配送管理

- 当選者の住所情報管理
- 配送状況の管理（発送済み/未発送）

### 2.5 利用確認・レビュー

- 商品到着後、利用確認やレビュー投稿機能

### 2.6 管理画面

- 案件の作成・編集・削除
- 応募者・当選者管理
- 配送・レビュー管理

## 3. 画面構成（例）

- トップページ（案件一覧）
- 案件詳細ページ
- 応募フォーム
- マイページ（応募履歴、当選履歴、レビュー投稿）
- 管理者用ダッシュボード

## 4. その他

- 利用規約・プライバシーポリシー等の静的ページ

---

## コーディングガイドライン・セキュリティ方針

- URI やパスワード、API キーなどの機密情報は、必ず`.env`ファイル等の環境変数で管理し、ソースコードやリポジトリに直接記載しないこと。
- `.env`ファイルは`.gitignore`に追加し、バージョン管理対象外とする。
- 設定例:
  ```env
  DATABASE_PASSWORD=xxxxxx
  SECRET_KEY_BASE=xxxxxx
  API_KEY=xxxxxx
  ```
- Rails や Next.js の設定ファイル（database.yml, next.config.js 等）では、環境変数を参照する形で記述する。
- 本番環境では、環境変数はサーバーや CI/CD の設定で安全に注入すること。
- その他、セキュリティ上の配慮事項（XSS/CSRF 対策、パスワードのハッシュ化等）も徹底する。

---

## エラーハンドリング・例外管理ガイドライン

- 予期しない例外やエラー発生時は、ユーザー向けに分かりやすいデフォルトエラーページ（404, 500 等）を表示する。
- Rails の `public/404.html`, `public/500.html` などをカスタマイズし、ブランドイメージや案内文を明記する。
- 生のエラーログやスタックトレースは、画面・API レスポンスに絶対に露出しない。
- エラー内容はサーバー側で適切にロギングし、個人情報や機密情報はマスク・除外する。
- API の場合も、エラー時は統一された JSON レスポンス（status, message, code 等）を返す。
- 例外処理は Controller や Service 層で責務分離し、アプリ全体で一貫したエラーハンドリングを徹底する。

---

## コーディングスタイル・設計原則

- 1 つの関数（メソッド）は原則 50 行以内を目安とし、長くなる場合は適切に分割する。
- 関数・メソッド・クラスは「単一責任の原則（Single Responsibility Principle）」を守り、1 つの役割・責務に集中させる。
- 複雑な処理や分岐は、ヘルパー関数やサービスクラス等に切り出して可読性・保守性を高める。
- 命名は役割・責務が明確に伝わるものとし、コメントやドキュメントも適宜記述する。
- コードレビュー時も「関数の肥大化」「責務の分散」「命名の曖昧さ」などに注意する。

---

## 技術スタック詳細

### 主要技術・ライブラリ

- Ruby on Rails（API/HTML 両対応）
  - ActiveRecord（ORM）
  - ActiveModel Serializers（API レスポンス整形）
  - Devise（認証）
  - ActiveAdmin（管理画面）
  - Kaminari（ページネーション）
  - RSpec（テスト）
  - FactoryBot（テストデータ生成）
  - RuboCop（静的解析・Lint）
  - dotenv-rails（環境変数管理）
  - pg（PostgreSQL ドライバ）
  - rack-cors（CORS 対応）
  - fast_jsonapi（高速 JSON シリアライザ、必要に応じて）
  - Sidekiq（非同期ジョブ、必要に応じて）
  - ERB（テンプレートエンジン、画面・メール等）
  - lookbook（Rails 用 UI カタログ/ドキュメント生成）
  - daisyUI（Tailwind CSS ベースの UI コンポーネント、必要に応じて JS で利用）
- JavaScript（必要に応じて、動的 UI やインタラクションで利用）

---

## UI カラー・文言管理ガイドライン

- サービス全体で使用する色（カラーパレット）や文言（ラベル・メッセージ・ボタン名等）は、一覧で参照・管理できる仕組みを導入する。
- 色は `config/colors.yml` や `app/assets/stylesheets/_colors.scss` などで一元管理し、View/Component で参照する。
- 文言は `config/locales/ja.yml` など i18n ファイルで一元管理し、View/Component/Controller で参照する。
- 新規追加・変更時は必ず一覧ファイルを更新し、重複・表記揺れを防ぐ。
- UI/UX・アクセシビリティ観点から、色・文言の統一・管理を徹底する。